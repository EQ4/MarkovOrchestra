#N canvas 522 215 294 404 10;
#X declare -path ./abs;
#X declare -lib jasch_lib -lib mrpeach;
#X obj -405 -347 cnv 15 290 400 empty empty empty 20 12 0 14 -232576
-66577 0;
#X obj -389 -331 bng 20 250 50 0 load_midi_file set-load_midi_file
empty 17 7 0 10 -261682 -1 -1;
#X obj -333 -296 hsl 200 16 40 239 0 0 tempo set-tempo empty 0 0 0
10 -262144 -1 -1 7600 1;
#X obj -333 -266 hsl 200 16 1 32 0 0 raw-density set-density empty
-2 -8 0 10 -262144 -1 -1 2568 1;
#X obj -333 -236 hsl 200 17 1 34 0 0 raw-legato set-legato empty -2
-8 0 10 -262144 -1 -1 18694 1;
#X obj -333 -206 hsl 200 17 0 1 0 0 raw-activity set-activity empty
-2 -8 0 10 -262144 -1 -1 0 1;
#X obj -333 -146 hsl 100 17 -6 6 0 0 raw-register set-register empty
-2 -8 0 10 -262144 -1 -1 4950 1;
#X text -374 -298 TEMPO;
#X text -387 -267 DENSITY;
#X text -380 -237 LEGATO;
#X text -392 -148 REGISTER;
#X text -263 -163 RANGE;
#X obj -226 -182 bng 8 250 50 0 learn-range --- empty 17 7 0 10 -262144
-1 -1;
#X obj -336 -156 bng 8 250 50 0 learn-register --- empty 17 7 0 10
-262144 -1 -1;
#X obj -336 -216 bng 8 250 50 0 learn-activity --- empty 17 7 0 10
-262144 -1 -1;
#X obj -336 -246 bng 8 250 50 0 learn-legato --- empty 17 7 0 10 -262144
-1 -1;
#X obj -336 -276 bng 8 250 50 0 learn-density --- empty 17 7 0 10 -262144
-1 -1;
#X obj -336 -306 bng 8 250 50 0 learn-tempo --- empty 17 7 0 10 -262144
-1 -1;
#X text -200 -159 | HARMONIC;
#X text -200 -149 | FILLER;
#X text -200 -169 | HOUSE;
#X text -135 -159 |;
#X text -135 -169 |;
#X text -135 -149 |;
#X obj -369 -331 bng 20 250 50 0 load_midi_file set-load_midi_file
empty 17 7 0 10 -261682 -1 -1;
#X obj -172 -331 tgl 20 0 play set-play empty 17 7 0 10 -262144 -1
-1 0 1;
#X obj -264 -331 tgl 20 0 clock-mode set-clock-mode empty 17 7 0 10
-262144 -1 -1 0 1;
#X obj -389 -331 cnv 15 40 20 empty empty LOAD 5 10 0 14 -159808 -262144
0;
#X obj -152 -331 tgl 20 0 play set-play empty 17 7 0 10 -262144 -1
-1 0 1;
#X obj -172 -331 cnv 15 40 20 empty gui-play PLAY 5 10 0 14 -159808
-262144 0;
#X obj -244 -331 tgl 20 0 clock-mode set-clock-mode empty 17 7 0 10
-262144 -1 -1 0 1;
#X obj -224 -331 tgl 20 0 clock-mode set-clock-mode empty 17 7 0 10
-262144 -1 -1 0 1;
#X obj -204 -331 tgl 20 0 clock-mode set-clock-mode empty 17 7 0 10
-262144 -1 -1 0 1;
#X obj -264 -331 cnv 15 80 20 empty gui-clock EXT-SYNC 9 10 0 14 -159808
-262144 0;
#X obj -226 -170 vsl 17 39 0 3.9 0 0 raw-range set-range empty 0 -9
0 10 -262144 -1 -1 0 1;
#X obj -262 -293 cnv 8 1 1 empty vis-tempo 116 20 5 0 12 -262144 -66577
0;
#X obj -253 -262 cnv 8 1 1 empty vis-density 5 20 5 0 12 -262144 -66577
0;
#X text -392 -207 ACTIVITY;
#X obj -316 -331 bng 20 250 50 0 reload empty empty 17 7 0 10 -261682
-1 -1;
#X obj -296 -331 bng 20 250 50 0 reload empty empty 17 7 0 10 -261682
-1 -1;
#X obj -336 -331 bng 20 250 50 0 reload empty empty 17 7 0 10 -261682
-1 -1;
#X obj -336 -331 cnv 15 60 20 empty empty RELOAD 7 10 0 14 -159808
-262144 0;
#X obj -333 -76 hsl 200 16 0 17 0 0 bass-density set-bass-density empty
-2 -8 0 10 -262144 -1 -1 5853 1;
#X text -387 -77 DENSITY;
#X obj -336 -86 bng 8 250 50 0 learn-bass-density --- empty 17 7 0
10 -262144 -1 -1;
#X obj -333 -46 hsl 200 16 0.2 1 0 0 bass-duration set-bass-duration
empty -2 -8 0 10 -262144 -1 -1 14729 1;
#X obj -336 -56 bng 8 250 50 0 learn-bass-duration --- empty 17 7 0
10 -262144 -1 -1;
#X text -392 -47 DURATION;
#X obj -333 -16 hsl 200 16 4 0.125 0 0 bass-velocity set-bass-velocity
empty -2 -8 0 10 -262144 -1 -1 19900 1;
#X obj -336 -26 bng 8 250 50 0 learn-bass-accents --- empty 17 7 0
10 -262144 -1 -1;
#X text -395 -210 ---------------------------------------------;
#X text -395 -207 ---------------------------------------------;
#X text -390 -17 ACCENTS;
#N canvas 771 23 498 369 patch 0;
#N canvas 639 37 524 685 adt 0;
#X obj -309 -62 r density;
#X obj -309 116 populate_rhythm;
#X obj -222 -62 r end-analysis;
#X obj -222 -39 tabdump master-pattern;
#X obj -219 154 tabset new-onsets;
#X obj -338 185 until;
#X msg -290 184 0;
#X obj -338 214 f 0;
#X obj -308 214 + 1;
#X obj -309 137 t b b l;
#X obj -92 282 tabread new-onsets;
#X obj -323 500 tabwrite slave-pattern;
#X obj -222 36 list-apply max 0;
#X obj -258 206 s slave-pattern;
#X obj -195 81 sum;
#X obj -222 58 t l l;
#X msg -338 163 32;
#X msg -258 184 const 0;
#X obj -309 -1 f;
#X obj -339 -39 r update-density;
#X obj -323 282 tabread master-pattern;
#X obj -323 309 expr if($f2==1 \, 1 \, if($f1==1 \, -1 \, $f1));
#X obj -338 236 t f f f f f;
#X obj 36 279 tabread legato-pattern;
#X obj -302 355 > 32;
#X obj -323 450 expr if($f2==-1 \, $f1 \, if($f1==1 \, 1 \, $f2));
#X obj -323 404 pack;
#X obj -323 381 swap;
#X obj -323 425 route 0 1;
#X obj -302 333 r force-legato;
#X obj -298 475 expr if($f1==1 \, $f1 \, $f2);
#X obj -215 9 s set-legato;
#X obj -185 104 s set-density;
#X msg -215 -14 32;
#X obj -338 522 sel 31;
#X obj -338 544 s update-legato;
#X obj -67 154 s onsets-bass;
#X obj -195 125 s set-bass-density;
#X connect 0 0 18 0;
#X connect 1 0 9 0;
#X connect 2 0 3 0;
#X connect 3 0 12 0;
#X connect 3 0 33 0;
#X connect 5 0 7 0;
#X connect 6 0 7 1;
#X connect 7 0 8 0;
#X connect 7 0 22 0;
#X connect 8 0 7 1;
#X connect 9 0 16 0;
#X connect 9 1 6 0;
#X connect 9 1 17 0;
#X connect 9 2 4 0;
#X connect 9 2 36 0;
#X connect 10 0 21 1;
#X connect 12 0 15 0;
#X connect 14 0 1 0;
#X connect 14 0 32 0;
#X connect 14 0 37 0;
#X connect 15 0 1 1;
#X connect 15 1 14 0;
#X connect 16 0 5 0;
#X connect 17 0 13 0;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 20 0 21 0;
#X connect 21 0 27 0;
#X connect 22 0 34 0;
#X connect 22 1 20 0;
#X connect 22 2 10 0;
#X connect 22 3 11 1;
#X connect 22 4 23 0;
#X connect 23 0 25 1;
#X connect 23 0 30 1;
#X connect 24 0 27 1;
#X connect 25 0 11 0;
#X connect 26 0 28 0;
#X connect 27 0 26 0;
#X connect 27 1 26 1;
#X connect 28 0 25 0;
#X connect 28 1 30 0;
#X connect 29 0 24 0;
#X connect 30 0 11 0;
#X connect 33 0 31 0;
#X connect 34 0 35 0;
#X restore -375 -249 pd adt;
#N canvas 8 23 811 700 gem_visualization 0;
#X msg 323 64 0 \, destroy;
#X floatatom 361 136 5 0 0 0 - - -;
#X msg 316 42 reset \, dimen 800 150 \, title Loop \, create \, 1;
#N canvas 281 99 481 734 grid 0;
#X obj 14 79 vis/grid-beat-strong;
#X obj 14 143 vis/grid-beat-soft;
#X obj 14 163 vis/grid-beat-soft;
#X obj 14 183 vis/grid-beat-soft;
#X obj 14 307 vis/grid-beat-soft;
#X obj 14 327 vis/grid-beat-soft;
#X obj 14 347 vis/grid-beat-soft;
#X obj 14 473 vis/grid-beat-soft;
#X obj 14 493 vis/grid-beat-soft;
#X obj 14 513 vis/grid-beat-soft;
#X obj 14 637 vis/grid-beat-soft;
#X obj 14 657 vis/grid-beat-soft;
#X obj 14 677 vis/grid-beat-soft;
#X obj 14 14 inlet;
#X obj 14 35 color 1 0 0 0.4;
#X obj 14 246 vis/grid-beat-strong;
#X obj 14 412 vis/grid-beat-strong;
#X obj 14 576 vis/grid-beat-strong;
#X obj 14 100 color 1 1 1 0.4;
#X obj 14 205 color 0 1 0 0.4;
#X obj 14 267 color 1 1 1 0.4;
#X obj 14 371 color 0 1 0 0.4;
#X obj 14 433 color 1 1 1 0.4;
#X obj 14 535 color 0 1 0 0.4;
#X obj 14 597 color 1 1 1 0.4;
#X obj 14 226 alpha 1;
#X obj 14 286 alpha 1;
#X obj 14 391 alpha 1;
#X obj 14 453 alpha 1;
#X obj 14 556 alpha 1;
#X obj 14 617 alpha 1;
#X obj 14 122 alpha 1;
#X obj 14 57 alpha 1;
#X obj 164 79 vis/grid-beat-strong;
#X obj 164 143 vis/grid-beat-soft;
#X obj 164 163 vis/grid-beat-soft;
#X obj 164 183 vis/grid-beat-soft;
#X obj 164 307 vis/grid-beat-soft;
#X obj 164 327 vis/grid-beat-soft;
#X obj 164 347 vis/grid-beat-soft;
#X obj 164 473 vis/grid-beat-soft;
#X obj 164 493 vis/grid-beat-soft;
#X obj 164 513 vis/grid-beat-soft;
#X obj 164 637 vis/grid-beat-soft;
#X obj 164 657 vis/grid-beat-soft;
#X obj 164 677 vis/grid-beat-soft;
#X obj 164 35 color 1 0 0 0.4;
#X obj 164 246 vis/grid-beat-strong;
#X obj 164 412 vis/grid-beat-strong;
#X obj 164 576 vis/grid-beat-strong;
#X obj 164 100 color 1 1 1 0.4;
#X obj 164 205 color 0 1 0 0.4;
#X obj 164 267 color 1 1 1 0.4;
#X obj 164 371 color 0 1 0 0.4;
#X obj 164 433 color 1 1 1 0.4;
#X obj 164 535 color 0 1 0 0.4;
#X obj 164 597 color 1 1 1 0.4;
#X obj 164 226 alpha 1;
#X obj 164 286 alpha 1;
#X obj 164 391 alpha 1;
#X obj 164 453 alpha 1;
#X obj 164 556 alpha 1;
#X obj 164 617 alpha 1;
#X obj 164 122 alpha 1;
#X obj 164 57 alpha 1;
#X obj 314 79 vis/grid-beat-strong;
#X obj 314 35 color 1 0 0 0.4;
#X obj 314 57 alpha 1;
#X connect 0 0 18 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 19 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 21 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 23 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 46 0;
#X connect 13 0 14 0;
#X connect 14 0 32 0;
#X connect 15 0 20 0;
#X connect 16 0 22 0;
#X connect 17 0 24 0;
#X connect 18 0 31 0;
#X connect 19 0 25 0;
#X connect 20 0 26 0;
#X connect 21 0 27 0;
#X connect 22 0 28 0;
#X connect 23 0 29 0;
#X connect 24 0 30 0;
#X connect 25 0 15 0;
#X connect 26 0 4 0;
#X connect 27 0 16 0;
#X connect 28 0 7 0;
#X connect 29 0 17 0;
#X connect 30 0 10 0;
#X connect 31 0 1 0;
#X connect 32 0 0 0;
#X connect 33 0 50 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 51 0;
#X connect 37 0 38 0;
#X connect 38 0 39 0;
#X connect 39 0 53 0;
#X connect 40 0 41 0;
#X connect 41 0 42 0;
#X connect 42 0 55 0;
#X connect 43 0 44 0;
#X connect 44 0 45 0;
#X connect 45 0 66 0;
#X connect 46 0 64 0;
#X connect 47 0 52 0;
#X connect 48 0 54 0;
#X connect 49 0 56 0;
#X connect 50 0 63 0;
#X connect 51 0 57 0;
#X connect 52 0 58 0;
#X connect 53 0 59 0;
#X connect 54 0 60 0;
#X connect 55 0 61 0;
#X connect 56 0 62 0;
#X connect 57 0 47 0;
#X connect 58 0 37 0;
#X connect 59 0 48 0;
#X connect 60 0 40 0;
#X connect 61 0 49 0;
#X connect 62 0 43 0;
#X connect 63 0 34 0;
#X connect 64 0 33 0;
#X connect 66 0 67 0;
#X connect 67 0 65 0;
#X restore 318 178 pd grid;
#X obj 318 156 translateXYZ -19.5 0 0;
#X obj 316 87 gemwin 20;
#X obj 318 114 gemhead 50;
#X obj 316 -2 loadbang;
#X obj 316 19 delay 500;
#N canvas 510 316 286 456 current-step 0;
#X obj 61 281 * 0.5;
#X obj 36 328 translateXYZ 0.75 0 0;
#X obj 79 166 * 1.2;
#X obj 61 303 * 1.2;
#X obj 79 190 - 19.5;
#X obj 36 211 translateXYZ -19.5 0 0;
#X obj 36 400 rectangle 0.75 3;
#X obj 61 237 loadbang;
#X obj 66 39 r current_step;
#X obj 56 84 mod 4;
#X msg 61 259 4;
#X obj 56 105 sel 0;
#X obj 66 60 t f f;
#X obj 99 142 f;
#X obj 36 17 gemhead 51;
#X obj 36 376 alpha 0;
#X obj 36 349 color 0.2 0.2 0.2 0.8;
#X connect 0 0 3 0;
#X connect 1 0 16 0;
#X connect 2 0 4 0;
#X connect 3 0 1 1;
#X connect 3 0 6 1;
#X connect 4 0 5 1;
#X connect 5 0 1 0;
#X connect 7 0 10 0;
#X connect 8 0 12 0;
#X connect 9 0 11 0;
#X connect 10 0 0 0;
#X connect 11 0 13 0;
#X connect 12 0 9 0;
#X connect 12 1 13 1;
#X connect 13 0 2 0;
#X connect 14 0 5 0;
#X connect 15 0 6 0;
#X connect 16 0 15 0;
#X restore 318 200 pd current-step;
#X obj 317 222 vis/master-chord-event 0;
#X obj -26 -3 r reset-analysis;
#X obj 598 -1 r reset-slaves;
#X obj 317 362 vis/master-chord-event 7;
#X obj 317 242 vis/master-chord-event 1;
#X obj 317 262 vis/master-chord-event 2;
#X obj 317 282 vis/master-chord-event 3;
#X obj 317 302 vis/master-chord-event 4;
#X obj 317 322 vis/master-chord-event 5;
#X obj 317 342 vis/master-chord-event 6;
#X msg -26 22 \; master-chord-fill-0 C 100 1 \; master-chord-fill-1
C 100 1 \; master-chord-fill-2 C 100 1 \; master-chord-fill-3 C 100
1 \; master-chord-fill-4 C 100 1 \; master-chord-fill-5 C 100 1 \;
master-chord-fill-6 C 100 1 \; master-chord-fill-7 C 100 1 \; slave-chord-pos-0
100 \; slave-chord-pos-1 100 \; slave-chord-pos-2 100 \; slave-chord-pos-3
100 \; slave-chord-pos-4 100 \; slave-chord-pos-5 100 \; slave-chord-pos-6
100 \; slave-chord-pos-7 100 \; slave-chord-pos-8 100 \; slave-chord-pos-9
100 \; slave-chord-pos-10 100 \; slave-chord-pos-11 100 \; slave-chord-pos-12
100 \; slave-chord-pos-13 100 \; slave-chord-pos-14 100 \; slave-chord-pos-15
100 \; slave-chord-pos-16 100 \; slave-chord-pos-17 100 \; slave-chord-pos-18
100 \; slave-chord-pos-19 100 \; slave-chord-pos-20 100 \; slave-chord-pos-21
100 \; slave-chord-pos-22 100 \; slave-chord-pos-23 100 \; slave-chord-pos-24
100 \; slave-chord-pos-25 100 \; slave-chord-pos-26 100 \; slave-chord-pos-27
100 \; slave-chord-pos-28 100 \; slave-chord-pos-29 100 \; slave-chord-pos-30
100 \; slave-chord-pos-31 100 \;;
#X msg 598 24 \; slave-chord-pos-0 100 \; slave-chord-pos-1 100 \;
slave-chord-pos-2 100 \; slave-chord-pos-3 100 \; slave-chord-pos-4
100 \; slave-chord-pos-5 100 \; slave-chord-pos-6 100 \; slave-chord-pos-7
100 \; slave-chord-pos-8 100 \; slave-chord-pos-9 100 \; slave-chord-pos-10
100 \; slave-chord-pos-11 100 \; slave-chord-pos-12 100 \; slave-chord-pos-13
100 \; slave-chord-pos-14 100 \; slave-chord-pos-15 100 \; slave-chord-pos-16
100 \; slave-chord-pos-17 100 \; slave-chord-pos-18 100 \; slave-chord-pos-19
100 \; slave-chord-pos-20 100 \; slave-chord-pos-21 100 \; slave-chord-pos-22
100 \; slave-chord-pos-23 100 \; slave-chord-pos-24 100 \; slave-chord-pos-25
100 \; slave-chord-pos-26 100 \; slave-chord-pos-27 100 \; slave-chord-pos-28
100 \; slave-chord-pos-29 100 \; slave-chord-pos-30 100 \; slave-chord-pos-31
100 \;;
#X obj 160 358 vis/slave-chord-event 18;
#X obj 160 398 vis/slave-chord-event 20;
#X obj 160 618 vis/slave-chord-event 31;
#X obj 160 -2 vis/slave-chord-event 0;
#X obj 160 238 vis/slave-chord-event 12;
#X obj 160 18 vis/slave-chord-event 1;
#X obj 160 418 vis/slave-chord-event 21;
#X obj 160 438 vis/slave-chord-event 22;
#X obj 160 378 vis/slave-chord-event 19;
#X obj 160 178 vis/slave-chord-event 9;
#X obj 160 198 vis/slave-chord-event 10;
#X obj 160 218 vis/slave-chord-event 11;
#X obj 160 258 vis/slave-chord-event 13;
#X obj 160 278 vis/slave-chord-event 14;
#X obj 160 298 vis/slave-chord-event 15;
#X obj 160 318 vis/slave-chord-event 16;
#X obj 160 338 vis/slave-chord-event 17;
#X obj 160 98 vis/slave-chord-event 5;
#X obj 160 78 vis/slave-chord-event 4;
#X obj 160 118 vis/slave-chord-event 6;
#X obj 160 138 vis/slave-chord-event 7;
#X obj 160 38 vis/slave-chord-event 2;
#X obj 160 58 vis/slave-chord-event 3;
#X obj 160 158 vis/slave-chord-event 8;
#X obj 160 458 vis/slave-chord-event 23;
#X obj 160 478 vis/slave-chord-event 24;
#X obj 160 498 vis/slave-chord-event 25;
#X obj 160 518 vis/slave-chord-event 26;
#X obj 160 538 vis/slave-chord-event 27;
#X obj 160 558 vis/slave-chord-event 28;
#X obj 160 578 vis/slave-chord-event 29;
#X obj 160 598 vis/slave-chord-event 30;
#X connect 0 0 5 0;
#X connect 1 0 4 1;
#X connect 2 0 5 0;
#X connect 4 0 3 0;
#X connect 6 0 4 0;
#X connect 7 0 8 0;
#X connect 8 0 2 0;
#X connect 11 0 20 0;
#X connect 12 0 21 0;
#X restore -375 -272 pd gem_visualization;
#N canvas 307 52 804 739 get-chord-progression 0;
#X obj -277 -1 inlet;
#X obj -277 43 make_chord;
#X obj 189 37 unpack 0 0 0 0;
#X obj 189 81 /;
#X obj 204 59 r ticks/4;
#X obj 243 82 != 0;
#X obj 189 102 * 4;
#X obj 198 192 route;
#X obj 198 168 t l f;
#X obj 189 124 pack;
#X obj 189 145 change_pack;
#X obj -277 20 t l l;
#X obj -21 296 add2list prepend;
#X msg 189 236 \$2 \$1;
#X obj 189 302 add2list prepend;
#X obj 389 251 r reset-analysis;
#X obj 189 344 list length;
#X obj -21 340 list length;
#X obj 160 380 ==;
#X obj 160 402 sel 1;
#X obj -15 463 list;
#X obj -21 319 t l l;
#X obj 189 322 t l l;
#X obj 195 458 list;
#X obj -15 483 drip 0;
#X obj 195 479 drip 0;
#X obj 189 257 route 1 0;
#X obj 296 302 add2list prepend;
#X obj 275 461 list;
#X obj 275 482 drip 0;
#X obj 254 551 -;
#X obj 254 527 swap;
#X obj 195 500 t f f;
#X obj 197 638 pack s f f;
#X obj 302 526 f 0;
#X obj 332 526 + 1;
#X obj 302 547 mod 8;
#X obj 275 504 t f b;
#X obj 287 664 s;
#X obj 302 568 makefilename master-chord-fill-%d;
#X obj 160 424 t b b b b;
#X text 319 663 chord \, onset \, duration.;
#X obj -277 628 outlet;
#X obj -226 628 outlet;
#X obj -270 66 midi_chord_estimator;
#X obj 24 548 compare-any;
#X obj 87 500 r reset-analysis;
#X msg 87 524 symbol nnnnn;
#X obj -15 504 t s s s;
#X obj 18 574 == 0;
#X obj -15 596 spigot;
#X obj 60 573 sel 1;
#X msg 60 596 symbol;
#X obj 198 215 tabwrite master-pattern;
#X obj -153 134 s fundamentals;
#X obj -153 89 change;
#X obj -60 88 r reset-analysis;
#X obj -153 112 add2list prepend;
#X connect 0 0 11 0;
#X connect 1 0 42 0;
#X connect 1 0 44 0;
#X connect 2 0 3 0;
#X connect 2 2 5 0;
#X connect 3 0 6 0;
#X connect 4 0 3 1;
#X connect 5 0 9 1;
#X connect 6 0 9 0;
#X connect 7 0 53 0;
#X connect 8 0 7 0;
#X connect 8 1 7 1;
#X connect 8 1 53 1;
#X connect 9 0 10 0;
#X connect 10 0 8 0;
#X connect 10 0 13 0;
#X connect 11 0 1 0;
#X connect 11 1 2 0;
#X connect 12 0 21 0;
#X connect 13 0 26 0;
#X connect 14 0 22 0;
#X connect 15 0 14 1;
#X connect 15 0 27 1;
#X connect 15 0 12 1;
#X connect 16 0 18 1;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 19 0 40 0;
#X connect 20 0 24 0;
#X connect 21 0 17 0;
#X connect 21 1 20 1;
#X connect 22 0 16 0;
#X connect 22 1 23 1;
#X connect 23 0 25 0;
#X connect 24 0 48 0;
#X connect 25 0 32 0;
#X connect 26 0 14 0;
#X connect 26 0 43 0;
#X connect 26 1 27 0;
#X connect 27 0 28 1;
#X connect 28 0 29 0;
#X connect 29 0 37 0;
#X connect 30 0 33 2;
#X connect 31 0 30 0;
#X connect 31 1 30 1;
#X connect 32 0 33 1;
#X connect 32 1 31 0;
#X connect 33 0 38 0;
#X connect 34 0 35 0;
#X connect 34 0 36 0;
#X connect 35 0 34 1;
#X connect 36 0 39 0;
#X connect 37 0 31 1;
#X connect 37 1 34 0;
#X connect 39 0 38 1;
#X connect 40 1 20 0;
#X connect 40 2 23 0;
#X connect 40 3 28 0;
#X connect 44 0 12 0;
#X connect 44 2 55 0;
#X connect 45 0 49 0;
#X connect 45 0 51 0;
#X connect 46 0 47 0;
#X connect 47 0 45 1;
#X connect 48 0 50 0;
#X connect 48 1 45 1;
#X connect 48 2 45 0;
#X connect 49 0 50 1;
#X connect 50 0 33 0;
#X connect 51 0 52 0;
#X connect 52 0 33 0;
#X connect 55 0 57 0;
#X connect 56 0 57 1;
#X connect 57 0 54 0;
#X restore -374 -182 pd get-chord-progression;
#N canvas 137 46 901 618 make-chord-variations 0;
#X msg 101 45 clear;
#X obj 116 -68 list-compare;
#X obj 83 -95 t l l l;
#X obj 83 -26 spigot;
#X obj 83 -118 inlet;
#X text 121 -119 receives list from makechord;
#X obj 152 -26 inlet;
#X obj 83 -2 list prepend;
#X obj 116 -47 == 0;
#X text 215 16 we need to make sure that al chords are ordered from
low to high...;
#X text 209 -96 we can use the argumentation by Tagg to take the first
chord of the shuttle as "tonic." According to this... it should be
quite easy to obtain the tonic of the shuttle.;
#X obj 101 22 r reset-analysis;
#X obj 145 55 r chord-variations;
#X text 194 -27 receives onset position from route 1;
#X obj 62 347 drip;
#X obj 62 325 list;
#X obj 182 124 t f f;
#N canvas 112 109 501 583 scales 0;
#X obj 115 340 list-unique;
#X obj 153 296 midi2pc;
#X obj 91 464 euclidean_distance;
#X obj 258 544 print a;
#X obj 309 433 mod 12;
#X obj 309 475 print lowest;
#X obj 246 494 list-unique;
#X obj 246 453 list-apply mod 12;
#X obj 230 332 add2list prepend;
#X obj 203 367 list;
#X obj 232 272 t b b;
#X obj 246 474 sort;
#X text 102 254 for scale obtention;
#X msg 131 175 0 60 65 69;
#X text 78 203 replacing a chord is as simple as rewriting a chord
on the same index!;
#X text 117 93 0 4 7;
#X text 117 113 0-1 4 7 (tercer grado);
#X text 116 66 substituciones!;
#X text 117 133 0 4 7+1 (sexto grado);
#X obj 246 410 normal_form;
#X obj 88 431 intervalic_structure;
#X connect 1 0 0 0;
#X connect 4 0 5 0;
#X connect 7 0 11 0;
#X connect 8 0 9 1;
#X connect 9 0 19 0;
#X connect 10 0 9 0;
#X connect 10 1 8 1;
#X connect 11 0 6 0;
#X connect 19 0 7 0;
#X connect 19 1 4 0;
#X restore 460 75 pd scales;
#X obj 182 183 sel -1;
#X obj 62 384 pack 0 0 1;
#X obj 232 303 * 80;
#X text 263 303 velocity;
#X obj 215 204 t b f f f;
#X obj 253 234 +;
#X obj 253 255 sel 2;
#X obj 83 215 coll one;
#C restore;
#X msg 471 135 0 60 64 67 71;
#X obj 461 162 s chord-variations;
#X msg 461 100 0 60 64 69 71;
#X text 294 215 -1 does nothing...;
#X text 300 233 0 silences what was sounding;
#X text 300 251 1 activates (and first mutes the previous chord);
#X obj 182 161 tabread slave-pattern;
#X obj 182 81 r current_step;
#X obj 62 405 noteout;
#X obj 239 349 sort;
#X obj 239 373 list split 1;
#X floatatom 239 398 5 0 0 0 - - -;
#X obj 239 419 s bass;
#X obj 83 248 t l l;
#X text -219 215 This is where all the pitch variations happen! ->
;
#X obj 253 276 midi_panic 1;
#X connect 0 0 25 0;
#X connect 1 0 8 0;
#X connect 2 0 3 0;
#X connect 2 1 1 1;
#X connect 2 2 1 0;
#X connect 3 0 7 0;
#X connect 4 0 2 0;
#X connect 6 0 7 1;
#X connect 7 0 25 0;
#X connect 8 0 3 1;
#X connect 11 0 0 0;
#X connect 12 0 25 0;
#X connect 14 0 19 0;
#X connect 15 0 14 0;
#X connect 16 0 32 0;
#X connect 16 1 25 0;
#X connect 18 1 22 0;
#X connect 19 0 34 0;
#X connect 20 0 19 1;
#X connect 22 0 15 0;
#X connect 22 1 20 0;
#X connect 22 2 23 1;
#X connect 22 3 23 0;
#X connect 23 0 24 0;
#X connect 24 0 41 0;
#X connect 25 0 39 0;
#X connect 26 0 27 0;
#X connect 28 0 27 0;
#X connect 32 0 18 0;
#X connect 33 0 16 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 37 0 38 0;
#X connect 39 0 15 1;
#X connect 39 1 35 0;
#X restore -374 -162 pd make-chord-variations;
#N canvas 153 101 466 618 load-midi-loop 0;
#X msg -268 40 flush;
#X obj -294 395 / 4;
#X obj -308 346 unpack 0 0 0 0 0;
#X obj -239 416 s ticks/4;
#X obj -268 62 t a b;
#X obj -121 172 s reset-analysis;
#X obj -233 -79 openpanel;
#X msg -233 -13 read \$1;
#X obj -206 207 midi_player;
#X obj -143 275 s end-analysis;
#X obj -233 -123 r load_midi_file;
#X obj -143 253 t b b;
#X obj -294 373 uanz;
#X obj -233 8 t b a;
#X obj -294 416 s bars;
#X obj -143 231 uanz;
#X obj -308 322 uanz;
#X obj -173 319 outlet;
#X obj -173 298 midi_sort;
#X msg -121 118 \; master-pattern const -1 \; slave-pattern const -1
;
#X obj -215 392 s set-tempo;
#X obj -215 369 spigot 0;
#X obj -170 347 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X text -149 346 get tempo from midi file (default = no);
#X msg -233 -100 symbol ./midi-chord-loops;
#X obj -233 -35 symbol;
#X obj -223 -58 r reload;
#X connect 0 0 4 0;
#X connect 1 0 14 0;
#X connect 2 0 12 0;
#X connect 2 3 3 0;
#X connect 2 4 21 0;
#X connect 4 0 8 0;
#X connect 4 1 5 0;
#X connect 4 1 12 1;
#X connect 4 1 16 1;
#X connect 4 1 15 1;
#X connect 4 1 19 0;
#X connect 6 0 25 0;
#X connect 7 0 13 0;
#X connect 8 1 18 0;
#X connect 8 2 16 0;
#X connect 8 3 15 0;
#X connect 10 0 24 0;
#X connect 11 0 9 0;
#X connect 11 1 18 1;
#X connect 12 0 1 0;
#X connect 13 0 0 0;
#X connect 13 1 8 0;
#X connect 15 0 11 0;
#X connect 16 0 2 0;
#X connect 18 0 17 0;
#X connect 21 0 20 0;
#X connect 22 0 21 1;
#X connect 24 0 6 0;
#X connect 25 0 7 0;
#X connect 26 0 25 0;
#X restore -374 -202 pd load-midi-loop;
#N canvas 360 23 516 734 slave-visualization 0;
#X obj 275 689 s;
#X obj -7 94 until;
#X obj 22 118 + 1;
#X obj -7 117 f 0;
#X obj 274 8 t b b;
#X obj 290 667 makefilename slave-chord-dur-%d;
#X obj 167 154 tabread slave-pattern;
#X msg 38 94 0;
#X obj 333 432 + 1;
#X obj 304 432 f 1;
#X msg 315 405 1;
#X obj 269 454 f;
#X obj 205 253 -;
#X obj 167 217 t f f f f;
#X msg 167 175 2 \$1;
#X obj 167 197 pow;
#X msg 301 154 10;
#X obj 304 254 sel 0.5;
#X obj 242 373 t b b;
#X obj 184 276 pack;
#X obj 242 334 sel2 2 0;
#X obj 315 333 sel -8;
#X obj 173 333 sel2 1 0.5;
#X obj 109 333 sel2 1 -1;
#X obj 40 333 sel2 2 1.5;
#X obj 104 259 moses 0;
#X obj 40 311 spigot;
#X obj -7 73 f 33;
#X obj 220 499 list;
#X obj -7 333 sel 32;
#X obj 251 551 list length;
#X obj 280 597 + 1;
#X obj 251 596 f 0;
#X msg 337 549 0;
#X obj 220 522 t l l b;
#X obj 251 573 until;
#X obj 218 664 packel;
#X obj 251 643 + 1;
#X obj 251 621 t b f f;
#X obj 218 620 list;
#X obj 311 479 add2list prepend;
#N canvas 425 157 377 519 density 0;
#X obj 49 342 f 0;
#X obj 79 342 + 1;
#X obj 34 388 s;
#X obj 64 270 r density;
#X msg 64 317 0;
#X obj 22 207 tabread new-onsets;
#X obj 91 316 s reset-slaves;
#X obj 22 227 pack;
#X obj 22 248 route 1;
#X obj 64 293 t b b;
#X obj 3 75 until;
#X obj 32 164 + 1;
#X obj 3 163 f 0;
#X obj 18 96 r reset-slaves;
#X msg 18 141 0;
#X obj 28 117 r reset-analysis;
#X msg 3 53 32;
#X obj -21 446 coll one;
#C restore;
#X obj 22 270 t f b;
#X obj 3 8 r density;
#X obj 49 364 makefilename slave-chord-pos-%d;
#X text -21 469 when we want to label substitute chords...;
#X obj -21 470 midi_chord_estimator;
#X obj -23 249 sel 31;
#X obj 3 186 t f f f;
#X obj 3 31 delay 1;
#X obj -23 418 s update-legato;
#X connect 0 0 1 0;
#X connect 0 0 20 0;
#X connect 1 0 0 1;
#X connect 3 0 9 0;
#X connect 4 0 0 1;
#X connect 5 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 18 0;
#X connect 9 0 4 0;
#X connect 9 1 6 0;
#X connect 10 0 12 0;
#X connect 11 0 12 1;
#X connect 12 0 11 0;
#X connect 12 0 24 0;
#X connect 13 0 14 0;
#X connect 14 0 12 1;
#X connect 15 0 14 0;
#X connect 16 0 10 0;
#X connect 17 0 22 0;
#X connect 18 0 2 0;
#X connect 18 1 0 0;
#X connect 19 0 25 0;
#X connect 20 0 2 1;
#X connect 23 0 26 0;
#X connect 24 0 23 0;
#X connect 24 1 5 0;
#X connect 24 2 7 1;
#X connect 25 0 16 0;
#X restore 1 -7 pd density;
#X obj 274 -14 r update-legato;
#X obj -7 52 del 10;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 3 0 2 0;
#X connect 3 0 6 0;
#X connect 3 0 29 0;
#X connect 4 0 43 0;
#X connect 4 1 7 0;
#X connect 4 1 16 0;
#X connect 4 1 40 1;
#X connect 5 0 0 1;
#X connect 6 0 14 0;
#X connect 7 0 3 1;
#X connect 8 0 9 1;
#X connect 9 0 8 0;
#X connect 9 0 11 1;
#X connect 10 0 9 0;
#X connect 11 0 40 0;
#X connect 12 0 19 1;
#X connect 12 0 21 0;
#X connect 13 0 25 0;
#X connect 13 1 19 0;
#X connect 13 1 17 0;
#X connect 13 2 12 1;
#X connect 13 3 12 0;
#X connect 14 0 15 0;
#X connect 15 0 13 0;
#X connect 16 0 12 1;
#X connect 17 0 9 0;
#X connect 18 0 10 0;
#X connect 18 1 11 0;
#X connect 19 0 20 0;
#X connect 19 0 22 0;
#X connect 19 0 23 0;
#X connect 19 0 26 0;
#X connect 20 0 18 0;
#X connect 21 0 10 0;
#X connect 22 0 18 0;
#X connect 23 0 18 0;
#X connect 24 0 18 0;
#X connect 25 1 26 1;
#X connect 26 0 24 0;
#X connect 27 0 1 0;
#X connect 28 0 34 0;
#X connect 29 0 28 0;
#X connect 30 0 35 0;
#X connect 31 0 32 1;
#X connect 32 0 31 0;
#X connect 32 0 38 0;
#X connect 33 0 32 1;
#X connect 34 0 30 0;
#X connect 34 1 39 1;
#X connect 34 2 33 0;
#X connect 35 0 32 0;
#X connect 36 0 0 0;
#X connect 37 0 36 1;
#X connect 38 0 39 0;
#X connect 38 1 37 0;
#X connect 38 2 5 0;
#X connect 39 0 36 0;
#X connect 40 0 28 1;
#X connect 42 0 4 0;
#X connect 43 0 27 0;
#X restore -245 -271 pd slave-visualization;
#X obj -222 -315 path ./abs;
#N canvas 0 22 450 300 (subpatch) 0;
#X array master-pattern 33 float 2;
#X coords 0 2 32 -2 200 50 1 0 0;
#X restore -98 -307 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array new-onsets 33 float 2;
#X coords 0 2 32 -2 200 50 1 0 0;
#X restore -99 -241 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array slave-pattern 33 float 2;
#X coords 0 2 32 -2 200 50 1 0 0;
#X restore -99 -106 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array legato-pattern 33 float 2;
#X coords 0 2 32 -2 200 50 1 0 0;
#X restore -99 -173 graph;
#N canvas 232 207 786 494 legato 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-legatorder 32 float 1;
#A 0 0 16 8 24 4 20 12 28 1 17 9 25 5 21 13 29 2 18 10 26 6 22 14 30
3 19 11 27 7 23 15 31;
#X coords 0 32 31 0 400 140 1 0 0;
#X restore 29 -63 graph;
#X text 11 83 descendientemente \, por compás;
#X obj 14 355 tabset \$0-legatorder;
#X msg 14 108 0 16 1 17 2 18 3 19 4 20 5 21 6 22 7 23 8 24 9 25 10
26 11 27 12 28 13 29 14 30 15 31;
#X msg 48 251 22 20 6 4 30 28 14 12 26 24 21 10 23 8 5 18 7 16 29 2
31 0 13 15 25 27 9 11 17 19 1 3;
#X text 46 228 from daniel1;
#X msg 59 309 3 1 19 17 11 9 27 25 15 13 0 31 2 29 16 7 18 5 8 23 10
21 24 26 12 14 28 30 4 6 20 22;
#X text 56 288 from daniel-inverse;
#X text 31 173 descendientemente \, por subtiempos débiles;
#X obj 24 154 loadbang;
#X msg 24 196 0 16 8 24 4 20 12 28 1 17 9 25 5 21 13 29 2 18 10 26
6 22 14 30 3 19 11 27 7 23 15 31;
#X obj 548 -42 r legato;
#X obj 465 159 tabwrite legato-pattern;
#X obj 540 124 tabread \$0-legatorder;
#X obj 587 28 s legato-pattern;
#X obj 552 75 sel;
#X obj 567 53 - 1;
#X obj 501 39 t f b f;
#X obj 552 99 s update-density;
#X msg 465 134 -1;
#X msg 587 6 const 0;
#X obj 501 14 for;
#X obj 548 -18 t f f b;
#X connect 3 0 2 0;
#X connect 4 0 2 0;
#X connect 6 0 2 0;
#X connect 9 0 10 0;
#X connect 10 0 2 0;
#X connect 11 0 22 0;
#X connect 13 0 12 1;
#X connect 15 0 18 0;
#X connect 16 0 15 1;
#X connect 17 0 15 0;
#X connect 17 1 19 0;
#X connect 17 2 13 0;
#X connect 19 0 12 0;
#X connect 20 0 14 0;
#X connect 21 0 17 0;
#X connect 22 0 21 0;
#X connect 22 1 16 0;
#X connect 22 2 20 0;
#X restore -331 -249 pd legato;
#N canvas 62 326 1137 449 control 0;
#X obj -60 318 s saturation;
#X obj -59 345 s substitution;
#X obj -49 209 s activity;
#X obj 39 96 s legato;
#X obj 39 74 min 32;
#X obj 47 53 s force-legato;
#X obj 39 21 int;
#X obj 39 -3 r raw-legato;
#X obj -61 61 s density;
#X obj -69 -3 r raw-density;
#X obj -69 19 int;
#X obj 158 20 int;
#X obj 158 -3 r raw-register;
#X obj 158 63 s register;
#X obj 159 94 r reset-analysis;
#X obj 169 158 s set-register;
#X msg 159 115 0;
#X text -64 294 these are NOT yet implemented!;
#X obj 179 138 s set-range;
#X obj 268 20 int;
#X obj 268 -3 r raw-range;
#X obj 268 63 s range;
#X obj -69 39 change;
#X obj 158 41 change;
#X obj 268 41 change;
#X obj -69 110 prepend label;
#X obj -69 86 tosymbol;
#X obj -69 133 s vis-density;
#X obj 510 33 midilearn;
#X msg 576 33 48 2;
#X obj 510 10 r learn-tempo;
#X obj 510 99 s set-tempo;
#X obj 510 57 maxlib/scale 0 127 40 239;
#X obj 510 79 int;
#X msg 576 153 29 1;
#X obj 510 199 int;
#X obj 510 130 r learn-density;
#X obj 510 177 maxlib/scale 0 127 1 32;
#X obj 510 219 s set-density;
#X msg 576 273 29 2;
#X obj 510 319 int;
#X msg 766 33 43 2;
#X obj 700 79 int;
#X obj 700 57 maxlib/scale 0 127 1 32;
#X obj 510 250 r learn-legato;
#X obj 510 297 maxlib/scale 0 127 1 34;
#X obj 510 339 s set-legato;
#X obj 700 10 r learn-activity;
#X obj 700 99 s set-activity;
#X msg 766 283 29 4;
#X obj 700 329 int;
#X msg 766 153 29 3;
#X obj 700 199 int;
#X obj 700 130 r learn-register;
#X obj 700 260 r learn-range;
#X obj 700 177 maxlib/scale 0 127 -6 6;
#X obj 700 349 s set-range;
#X obj 700 219 s set-register;
#X obj 700 307 maxlib/scale 0 127 0 4;
#X obj 365 -3 r tempo;
#X obj 365 44 prepend label;
#X obj 365 20 tosymbol;
#X obj 365 67 s vis-tempo;
#X obj 510 153 midilearn;
#X obj 510 273 midilearn;
#X obj 700 33 midilearn;
#X obj 700 283 midilearn;
#X obj 700 153 midilearn;
#X obj -49 182 r raw-activity;
#X obj 159 178 s set-activity;
#X msg 956 33 33 1;
#X obj 890 79 int;
#X msg 956 283 33 3;
#X msg 956 153 33 2;
#X obj 890 33 midilearn;
#X obj 890 283 midilearn;
#X obj 890 153 midilearn;
#X obj 890 10 r learn-bass-density;
#X obj 890 57 maxlib/scale 0 127 0 17;
#X obj 890 130 r learn-bass-duration;
#X obj 890 99 s set-bass-density;
#X obj 890 199 s set-bass-duration;
#X obj 890 260 r learn-bass-accents;
#X obj 890 177 maxlib/scale 0 127 0.2 1;
#X floatatom 861 346 5 0 0 0 - - -;
#X obj 890 329 s set-bass-velocity;
#X obj 890 307 maxlib/scale 0 127 4 0.125;
#X connect 4 0 3 0;
#X connect 6 0 5 0;
#X connect 6 0 4 0;
#X connect 7 0 6 0;
#X connect 9 0 10 0;
#X connect 10 0 22 0;
#X connect 11 0 23 0;
#X connect 12 0 11 0;
#X connect 14 0 16 0;
#X connect 16 0 15 0;
#X connect 16 0 18 0;
#X connect 16 0 69 0;
#X connect 19 0 24 0;
#X connect 20 0 19 0;
#X connect 22 0 8 0;
#X connect 22 0 26 0;
#X connect 23 0 13 0;
#X connect 24 0 21 0;
#X connect 25 0 27 0;
#X connect 26 0 25 0;
#X connect 28 0 32 0;
#X connect 28 1 29 0;
#X connect 29 0 28 1;
#X connect 30 0 28 0;
#X connect 32 0 33 0;
#X connect 33 0 31 0;
#X connect 34 0 63 1;
#X connect 35 0 38 0;
#X connect 36 0 63 0;
#X connect 37 0 35 0;
#X connect 39 0 64 1;
#X connect 40 0 46 0;
#X connect 41 0 65 1;
#X connect 42 0 48 0;
#X connect 43 0 42 0;
#X connect 44 0 64 0;
#X connect 45 0 40 0;
#X connect 47 0 65 0;
#X connect 49 0 66 1;
#X connect 50 0 56 0;
#X connect 51 0 67 1;
#X connect 52 0 57 0;
#X connect 53 0 67 0;
#X connect 54 0 66 0;
#X connect 55 0 52 0;
#X connect 58 0 50 0;
#X connect 59 0 61 0;
#X connect 60 0 62 0;
#X connect 61 0 60 0;
#X connect 63 0 37 0;
#X connect 63 1 34 0;
#X connect 64 0 45 0;
#X connect 64 1 39 0;
#X connect 65 0 43 0;
#X connect 65 1 41 0;
#X connect 66 0 58 0;
#X connect 66 1 49 0;
#X connect 67 0 55 0;
#X connect 67 1 51 0;
#X connect 68 0 2 0;
#X connect 70 0 74 1;
#X connect 71 0 80 0;
#X connect 72 0 75 1;
#X connect 73 0 76 1;
#X connect 74 0 78 0;
#X connect 74 1 70 0;
#X connect 75 0 86 0;
#X connect 75 1 72 0;
#X connect 76 0 83 0;
#X connect 76 1 73 0;
#X connect 77 0 74 0;
#X connect 78 0 71 0;
#X connect 79 0 76 0;
#X connect 82 0 75 0;
#X connect 83 0 81 0;
#X connect 86 0 84 0;
#X connect 86 0 85 0;
#X restore -376 -294 pd control from pd-gui;
#N canvas 18 41 859 568 clock 0;
#X floatatom 426 459 5 0 0 0 - - -;
#X obj 261 287 /;
#X obj 143 439 + 1;
#X obj 113 439 f 0;
#X msg 162 415 0;
#X msg 261 264 15000 \$1;
#X obj 140 491 sel 0 31;
#X obj 113 471 t f f;
#X obj 138 336 metro 125;
#X obj 261 241 r tempo;
#X obj 48 43 unpackOSC;
#X obj 113 410 t b;
#X floatatom 124 92 5 0 0 0 - - -;
#X obj 48 375 sel 0;
#X msg 58 400 0;
#X obj 123 536 s current_step;
#X obj 138 247 r play;
#X obj 164 361 r clock-mode;
#X obj 426 406 packOSC;
#X obj 426 436 udpsend;
#X obj 48 18 udpreceive 8000;
#X obj 113 385 multiplex;
#X obj 183 225 r clock-mode;
#X obj 138 276 f;
#X obj 183 247 t b f;
#X obj 210 279 sel 1;
#X obj -42 41 r clock-mode;
#X obj -15 104 - 1;
#X obj -15 127 abs;
#X obj -60 149 spigot 1;
#X obj -60 221 sel 1 0;
#X obj -60 281 prepend label;
#X obj -60 304 s gui-play;
#X msg -60 246 STOP;
#X msg -25 246 PLAY;
#X obj -50 196 s set-play;
#X msg -50 173 set \$1;
#X obj 346 77 sel 1 0;
#X obj 346 5 r play;
#X obj 346 137 prepend label;
#X obj 346 162 s gui-play;
#X msg 346 102 STOP;
#X msg 381 102 PLAY;
#X obj 398 78 loadbang;
#X msg 354 29 set \$1;
#X obj 354 52 s set-play;
#X obj 460 77 sel 1 0;
#X obj 460 157 prepend label;
#X obj 460 7 r clock-mode;
#X obj 460 182 s gui-clock;
#X msg 426 384 /setTempo \$1;
#X obj 48 67 routeOSC /status /step /tempoLive;
#X obj 426 350 spigot 0;
#X obj 535 229 r clock-mode;
#X obj 426 300 f;
#X obj 481 261 t b f;
#X obj 426 261 r tempo;
#X obj 508 283 - 1;
#X obj 508 303 abs;
#X obj 178 127 spigot 0;
#X obj 255 5 r clock-mode;
#X obj 255 26 - 1;
#X obj 255 46 abs;
#X msg 475 33 set \$1;
#X obj 475 56 s set-clock-mode;
#X obj 535 380 sel 0;
#X msg 460 129 INTERNAL;
#X obj 255 70 t b f;
#X obj 178 150 s set-tempo;
#X msg 525 129 EXT-SYNC;
#X obj -60 103 f;
#X obj -42 64 t b f;
#X obj 317 312 r play;
#X obj 317 341 spigot 0;
#X msg 317 368 /setTransport \$1;
#X obj 138 296 spigot 1;
#X floatatom 72 91 5 0 0 0 - - -;
#X obj 599 66 loadbang;
#X msg 535 402 disconnect \, connect localhost 8002;
#X obj 48 290 spigot 0;
#X obj 58 222 r clock-mode;
#X obj 58 243 - 1;
#X obj 58 263 abs;
#X obj 609 119 s set-clock-mode;
#X msg 609 96 1;
#X obj 659 185 r tempo;
#X obj 659 232 prepend label;
#X obj 659 208 tosymbol;
#X obj 659 255 s vis-tempo;
#X obj 178 101 f 125;
#X obj 48 536 midi_panic;
#X obj 140 513 midi_panic 1;
#X connect 1 0 8 1;
#X connect 2 0 3 1;
#X connect 3 0 2 0;
#X connect 3 0 7 0;
#X connect 4 0 3 1;
#X connect 5 0 1 0;
#X connect 6 0 91 0;
#X connect 6 1 4 0;
#X connect 7 0 15 0;
#X connect 7 1 6 0;
#X connect 8 0 21 1;
#X connect 9 0 5 0;
#X connect 10 0 51 0;
#X connect 11 0 3 0;
#X connect 13 0 14 0;
#X connect 13 0 90 0;
#X connect 14 0 3 1;
#X connect 16 0 23 0;
#X connect 17 0 21 2;
#X connect 18 0 19 0;
#X connect 19 0 0 0;
#X connect 20 0 10 0;
#X connect 21 0 11 0;
#X connect 22 0 24 0;
#X connect 23 0 75 0;
#X connect 24 0 23 0;
#X connect 24 1 25 0;
#X connect 24 1 75 1;
#X connect 25 1 8 0;
#X connect 26 0 71 0;
#X connect 27 0 28 0;
#X connect 28 0 29 1;
#X connect 29 0 30 0;
#X connect 29 0 36 0;
#X connect 30 0 33 0;
#X connect 30 1 34 0;
#X connect 31 0 32 0;
#X connect 33 0 31 0;
#X connect 34 0 31 0;
#X connect 36 0 35 0;
#X connect 37 0 41 0;
#X connect 37 1 42 0;
#X connect 38 0 37 0;
#X connect 38 0 44 0;
#X connect 39 0 40 0;
#X connect 41 0 39 0;
#X connect 42 0 39 0;
#X connect 43 0 42 0;
#X connect 44 0 45 0;
#X connect 46 0 66 0;
#X connect 46 1 69 0;
#X connect 47 0 49 0;
#X connect 48 0 46 0;
#X connect 48 0 63 0;
#X connect 50 0 18 0;
#X connect 51 0 23 1;
#X connect 51 0 70 0;
#X connect 51 0 76 0;
#X connect 51 0 79 0;
#X connect 51 1 12 0;
#X connect 51 1 21 0;
#X connect 51 2 89 0;
#X connect 52 0 50 0;
#X connect 53 0 55 0;
#X connect 53 0 65 0;
#X connect 54 0 52 0;
#X connect 55 0 54 0;
#X connect 55 1 57 0;
#X connect 56 0 54 0;
#X connect 57 0 58 0;
#X connect 58 0 52 1;
#X connect 58 0 73 1;
#X connect 59 0 68 0;
#X connect 60 0 61 0;
#X connect 61 0 62 0;
#X connect 62 0 67 0;
#X connect 63 0 64 0;
#X connect 65 0 78 0;
#X connect 66 0 47 0;
#X connect 67 0 89 0;
#X connect 67 1 59 1;
#X connect 69 0 47 0;
#X connect 70 0 29 0;
#X connect 71 0 70 0;
#X connect 71 1 27 0;
#X connect 72 0 73 0;
#X connect 73 0 74 0;
#X connect 74 0 18 0;
#X connect 75 0 8 0;
#X connect 75 0 13 0;
#X connect 77 0 84 0;
#X connect 77 0 66 0;
#X connect 78 0 19 0;
#X connect 79 0 13 0;
#X connect 80 0 81 0;
#X connect 81 0 82 0;
#X connect 82 0 79 1;
#X connect 84 0 83 0;
#X connect 85 0 87 0;
#X connect 86 0 88 0;
#X connect 87 0 86 0;
#X connect 89 0 59 0;
#X restore -236 -294 pd clock;
#X obj -375 -315 import jasch_lib mrpeach;
#X obj -374 -135 loadbang;
#X msg -374 -110 \; set-tempo 125;
#N canvas 339 23 928 751 activity 0;
#X obj 439 8 tabdump new-onsets;
#X obj 394 30 listfind;
#X msg 394 8 1;
#X obj 270 2 tabread \$0-activity;
#X obj 306 65 listfind;
#X obj 306 90 route float bang;
#X obj 421 126 f;
#X obj 450 126 + 1;
#X obj 436 104 f;
#X obj 282 165 add2list prepend;
#X obj 282 207 list length;
#X obj 446 79 r voice-changes;
#X obj 282 186 t l l;
#X obj 288 295 list;
#X obj 297 228 r voice-changes;
#X obj 282 250 ==;
#X obj 288 273 sel 1;
#X obj 288 317 sort;
#X obj 270 26 t f f;
#X obj 282 143 f;
#X obj 306 112 t b;
#X obj 243 -99 t f b b;
#X obj 394 -14 t b b b;
#X obj 288 476 listfind;
#X obj 288 498 route float;
#X obj -23 -96 r density;
#X obj 41 -96 r activity;
#X obj 41 -42 *;
#X obj 41 -69 t b f;
#X obj 41 1 int;
#X floatatom 71 22 5 0 0 0 - - -;
#X obj 583 174 coll one;
#C restore;
#X obj 562 218 t b l;
#X obj 476 244 f;
#X obj 476 315 list;
#X obj 608 433 list prepend;
#X obj 476 266 t b f;
#N canvas 431 22 495 459 activity 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-activity 32 float 1;
#A 0 0 16 8 24 4 20 12 28 1 17 9 25 5 21 13 29 2 18 10 26 6 22 14 30
3 19 11 27 7 23 15 31;
#X coords 0 32 31 0 400 140 1 0 0;
#X restore 14 -37 graph;
#X text 11 103 descendientemente \, por compás;
#X msg 14 128 0 16 1 17 2 18 3 19 4 20 5 21 6 22 7 23 8 24 9 25 10
26 11 27 12 28 13 29 14 30 15 31;
#X msg 48 271 22 20 6 4 30 28 14 12 26 24 21 10 23 8 5 18 7 16 29 2
31 0 13 15 25 27 9 11 17 19 1 3;
#X text 46 248 from daniel1;
#X msg 59 329 3 1 19 17 11 9 27 25 15 13 0 31 2 29 16 7 18 5 8 23 10
21 24 26 12 14 28 30 4 6 20 22;
#X text 56 308 from daniel-inverse;
#X text 31 193 descendientemente \, por subtiempos débiles;
#X obj 24 174 loadbang;
#X msg 24 216 0 16 8 24 4 20 12 28 1 17 9 25 5 21 13 29 2 18 10 26
6 22 14 30 3 19 11 27 7 23 15 31;
#X obj 14 375 tabset \$0-activity;
#X connect 2 0 10 0;
#X connect 3 0 10 0;
#X connect 5 0 10 0;
#X connect 8 0 9 0;
#X connect 9 0 10 0;
#X restore -148 276 pd activity table order;
#X obj 288 340 t b l;
#X msg 288 362 32;
#X obj 288 414 t f f;
#X obj 562 197 list;
#X obj 562 151 t b f;
#X obj 503 290 chord_rotate_manual;
#X floatatom 79 -69 5 0 0 0 - - -;
#X text 83 -20 number of chords;
#X floatatom 150 -67 5 0 0 0 - - -;
#X obj 41 44 change;
#X obj 625 21 list-compare;
#X obj 592 -6 t l l l;
#X obj 592 63 spigot;
#X obj 625 42 == 0;
#X obj 243 -74 for;
#X obj 288 385 for;
#X obj -168 -4 random 2;
#X obj -168 20 sel 0;
#X msg -168 44 -1;
#X obj -168 -26 t b;
#X obj -139 -82 for;
#X obj -168 72 add2list prepend;
#X msg -75 50 0;
#X msg -139 -127 16;
#X obj -139 -58 sel 0;
#X obj -168 122 list;
#X obj -38 63 sel;
#X obj -23 42 - 1;
#X obj -139 -104 t f f;
#N canvas 0 22 450 278 (subpatch) 0;
#X array r-voicing 16 float 3;
#A 0 0 1 -1 1 -1 1 1 -1 1 1 1 1 1 1 -1 1;
#X coords 0 1.1 16 -1.1 100 70 1 0 0;
#X restore -168 179 graph;
#X obj -168 144 tabset r-voicing;
#X text -106 -126 GET NEW RANDOM DISTRIBUTION;
#X obj 181 271 print some;
#X obj 64 112 s voice-changes;
#X obj 288 520 tabread r-voicing;
#X obj 41 66 + 1;
#X obj 415 56 print onset-positions;
#X floatatom 88 79 5 0 0 0 - - -;
#X obj 243 -51 t f f;
#X obj 223 -25 + 16;
#X obj 41 -20 * 0.4;
#X obj 608 454 s chord-variations;
#X obj 164 362 drip;
#X msg 164 338 0 16 24;
#X obj 164 388 moses 16;
#X connect 0 0 1 1;
#X connect 1 0 4 1;
#X connect 1 0 74 0;
#X connect 2 0 1 0;
#X connect 3 0 18 0;
#X connect 4 0 5 0;
#X connect 5 0 20 0;
#X connect 5 1 6 0;
#X connect 6 0 7 0;
#X connect 6 0 3 0;
#X connect 7 0 6 1;
#X connect 8 0 6 1;
#X connect 9 0 12 0;
#X connect 10 0 15 0;
#X connect 11 0 8 0;
#X connect 12 0 10 0;
#X connect 12 1 13 1;
#X connect 13 0 17 0;
#X connect 14 0 15 1;
#X connect 15 0 16 0;
#X connect 16 0 13 0;
#X connect 17 0 38 0;
#X connect 17 0 70 0;
#X connect 17 0 80 0;
#X connect 18 0 4 0;
#X connect 18 1 19 1;
#X connect 19 0 9 0;
#X connect 20 0 19 0;
#X connect 21 0 52 0;
#X connect 21 1 8 0;
#X connect 21 2 22 0;
#X connect 22 0 2 0;
#X connect 22 1 9 1;
#X connect 22 2 0 0;
#X connect 23 0 24 0;
#X connect 24 0 72 0;
#X connect 25 0 27 0;
#X connect 26 0 28 0;
#X connect 26 0 44 0;
#X connect 27 0 78 0;
#X connect 28 0 27 0;
#X connect 28 1 27 1;
#X connect 29 0 30 0;
#X connect 29 0 47 0;
#X connect 31 0 41 1;
#X connect 32 0 33 0;
#X connect 32 1 43 1;
#X connect 33 0 36 0;
#X connect 34 0 35 0;
#X connect 35 0 79 0;
#X connect 36 0 34 0;
#X connect 36 1 43 0;
#X connect 38 0 39 0;
#X connect 38 1 23 1;
#X connect 39 0 53 0;
#X connect 40 0 23 0;
#X connect 41 0 32 0;
#X connect 42 0 41 0;
#X connect 42 1 31 0;
#X connect 42 1 35 1;
#X connect 43 0 34 1;
#X connect 46 0 27 0;
#X connect 47 0 73 0;
#X connect 48 0 51 0;
#X connect 49 0 50 0;
#X connect 49 1 48 1;
#X connect 49 2 48 0;
#X connect 51 0 50 1;
#X connect 52 0 76 0;
#X connect 53 0 40 0;
#X connect 54 0 55 0;
#X connect 55 0 56 0;
#X connect 55 1 59 0;
#X connect 56 0 59 0;
#X connect 57 0 54 0;
#X connect 58 0 62 0;
#X connect 59 0 63 1;
#X connect 60 0 59 1;
#X connect 61 0 66 0;
#X connect 62 0 60 0;
#X connect 62 1 57 0;
#X connect 62 1 64 0;
#X connect 63 0 68 0;
#X connect 64 0 63 0;
#X connect 65 0 64 1;
#X connect 66 0 58 0;
#X connect 66 1 65 0;
#X connect 72 0 33 1;
#X connect 73 0 71 0;
#X connect 73 0 21 0;
#X connect 73 0 75 0;
#X connect 76 0 77 0;
#X connect 76 1 3 0;
#X connect 77 0 3 0;
#X connect 78 0 29 0;
#X connect 80 0 82 0;
#X connect 81 0 80 0;
#X restore -269 -249 pd activity;
#N canvas 351 45 582 428 register 0;
#X obj 137 90 coll one;
#C restore;
#X msg 137 68 dump;
#X obj 96 116 t b l;
#X obj 47 195 >= 0;
#X obj 47 218 sel 0;
#X obj 20 151 f;
#X obj 91 36 t b f;
#X obj 20 295 list;
#X msg 47 242 -1;
#X obj 178 324 list prepend;
#X obj 84 -14 t f f;
#X obj 91 13 -;
#X obj 20 173 t b f;
#X obj 425 114 coll one;
#C restore;
#X msg 425 92 dump;
#X obj 397 140 t b l;
#X obj 371 224 list prepend;
#X obj 387 -37 r range;
#X obj 402 16 -;
#X obj 387 -13 t f f f;
#X obj 387 38 *;
#X obj 441 -10 r set-range;
#X obj 387 59 t b f;
#X obj 361 175 f;
#X text 349 272 sumar restar 12 a cada cambio;
#X text 349 292 en vez de calcular la distancia;
#X text 349 313 de octava;
#X obj 84 -37 r register;
#X obj 74 270 chord_rotate_manual;
#X obj 361 200 chord-range;
#X obj 178 346 s chord-variations;
#X obj 371 245 s chord-variations;
#X connect 0 0 2 0;
#X connect 0 1 9 1;
#X connect 1 0 0 0;
#X connect 2 0 5 0;
#X connect 2 1 28 1;
#X connect 3 0 4 0;
#X connect 4 0 8 0;
#X connect 4 1 28 0;
#X connect 5 0 12 0;
#X connect 6 0 1 0;
#X connect 6 1 5 1;
#X connect 7 0 9 0;
#X connect 8 0 28 0;
#X connect 9 0 30 0;
#X connect 10 0 11 1;
#X connect 10 1 11 0;
#X connect 11 0 6 0;
#X connect 12 0 7 0;
#X connect 12 1 3 0;
#X connect 13 0 15 0;
#X connect 13 1 16 1;
#X connect 14 0 13 0;
#X connect 15 0 23 0;
#X connect 15 1 29 1;
#X connect 16 0 31 0;
#X connect 17 0 19 0;
#X connect 18 0 20 1;
#X connect 19 0 20 0;
#X connect 19 1 18 1;
#X connect 19 2 18 0;
#X connect 20 0 22 0;
#X connect 21 0 18 1;
#X connect 22 0 14 0;
#X connect 22 1 23 1;
#X connect 23 0 29 0;
#X connect 27 0 10 0;
#X connect 28 0 7 1;
#X connect 29 0 16 0;
#X restore -375 -226 pd register and range;
#X text -375 -74 TO DO's:;
#X text -98 -46 angel.faraldo@upf.edu \, BCN \, 2015;
#X text -376 -20 rethink chord-substitution and expansion.;
#X text -376 0 circular visualization?? processing??;
#X text -376 20 add colors to chord height... (brigthness) and range.
;
#X text -375 -57 density bug cuando llega a 15 hace 16;
#X text -376 -40 legato does not always visualize correctly.;
#N canvas 434 165 527 334 BASS 0;
#N canvas 789 265 314 362 tables 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array nonext 16 float 3;
#A 0 4 2 5 3 6 5 1 8 3 7 6 3 7 8 6 6;
#X coords 0 3 15 -3 200 50 1 0 0;
#X restore 53 53 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array next 16 float 3;
#A 0 4 2 5 3 4 5 1 2 3 5 4 3 5 2 4 4;
#X coords 0 3 15 -3 200 50 1 0 0;
#X restore 54 127 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array id2d 32 float 3;
#A 0 0 1 1 1 1 2 2 2 2 2 2 3 3 3 3 4 0 1 1 1 1 2 2 2 2 2 2 3 3 3 3
4;
#X coords 0 4 31 0 200 140 1 0 0;
#X restore 46 198 graph;
#X restore 24 292 pd tables needed;
#X text 128 291 <- dont erase this. there are some tables needed for
this thing to work;
#N canvas 109 23 1038 652 onset2note 0;
#X obj 45 -182 inlet;
#X obj 128 -144 table riddm;
#X obj 128 -165 tabset riddm;
#N canvas 465 82 691 699 salience 0;
#X obj 24 17 inlet;
#X obj 41 132 list split 1;
#X obj 110 188 list split 1;
#X obj 68 211 == 1;
#X obj 102 211 == 0;
#X obj 68 235 &&;
#X obj 104 168 list;
#X obj 41 151 t b f;
#X obj 74 87 list split 1;
#X obj 40 114 list append;
#X obj 147 395 list;
#X obj 23 459 list;
#X obj 69 395 list prepend;
#X obj 23 527 list split 1;
#X msg 240 181 bang;
#X obj 128 493 list length;
#X obj 23 476 t a a;
#X obj 128 510 - 1;
#X obj 125 301 f;
#X obj 160 300 + 1;
#X msg 352 162 0;
#X obj 23 37 t b a a b b;
#X msg 125 282 bang;
#X obj 68 265 t f f;
#N canvas 0 22 450 300 (subpatch) 0;
#X array salience 16 float 1;
#A 0 -1 4 -3 6 -6 0.5 -6.5 1 -6 0.5 -6.5 1 -4 1.5 -5.5 3;
#X coords 0 4 15 -4 200 140 1 0 0;
#X restore 421 174 graph;
#X msg 365 326 \; salience 0 4 -1 1 -2 2 -1 1 -3 3 -1 1 -2 2 -1 1 -4
;
#X obj 125 319 tabread salience;
#X obj 68 336 *;
#X obj 69 375 int;
#X obj 23 581 outlet;
#X text 290 33 find the salient notes of a rhythmic phrase;
#X obj 68 356 * -1;
#X obj 244 541 outlet;
#X text 28 598 todos;
#X text 225 558 solo positivos;
#X text 224 572 (syncopations);
#X obj 451 537 outlet;
#X text 432 554 solo negativos;
#X text 434 572 (reinforcements);
#X obj 351 426 list;
#X obj 244 445 list;
#X obj 265 426 list prepend;
#X obj 244 515 list split 1;
#X obj 349 481 list length;
#X obj 244 464 t a a;
#X obj 349 498 - 1;
#X obj 265 393 moses 0;
#X obj 23 428 t b b b;
#X msg 225 407 0;
#X connect 0 0 21 0;
#X connect 1 0 7 0;
#X connect 1 1 2 0;
#X connect 1 1 6 1;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 4 0 5 1;
#X connect 5 0 23 0;
#X connect 6 0 1 0;
#X connect 7 0 6 0;
#X connect 7 1 3 0;
#X connect 8 0 9 1;
#X connect 9 0 1 0;
#X connect 10 0 12 1;
#X connect 11 0 16 0;
#X connect 12 0 10 0;
#X connect 12 0 11 1;
#X connect 13 0 29 0;
#X connect 14 0 12 1;
#X connect 14 0 41 1;
#X connect 15 0 17 0;
#X connect 16 0 13 0;
#X connect 16 1 15 0;
#X connect 17 0 13 1;
#X connect 18 0 19 0;
#X connect 18 0 26 0;
#X connect 19 0 18 1;
#X connect 20 0 18 1;
#X connect 21 0 47 0;
#X connect 21 1 9 0;
#X connect 21 2 8 0;
#X connect 21 3 14 0;
#X connect 21 4 20 0;
#X connect 22 0 18 0;
#X connect 23 0 27 0;
#X connect 23 1 22 0;
#X connect 26 0 27 1;
#X connect 27 0 31 0;
#X connect 28 0 12 0;
#X connect 28 0 46 0;
#X connect 31 0 28 0;
#X connect 39 0 41 1;
#X connect 40 0 44 0;
#X connect 41 0 39 0;
#X connect 41 0 40 1;
#X connect 42 0 32 0;
#X connect 43 0 45 0;
#X connect 44 0 42 0;
#X connect 44 1 43 0;
#X connect 45 0 42 1;
#X connect 46 0 48 0;
#X connect 46 1 41 0;
#X connect 47 0 11 0;
#X connect 47 1 40 0;
#X connect 48 0 41 0;
#X restore 45 -113 pd salience;
#N canvas 270 114 857 503 calculate 0;
#X obj 334 173 list split 1;
#X obj 334 194 t b a;
#X obj 377 212 list;
#X obj 420 258 f;
#X obj 442 258 + 1;
#X msg 436 169 0;
#X obj 366 241 t f b;
#X obj 350 283 sel 0;
#X obj 474 279 t f f;
#X obj 378 327 +;
#X obj 231 87 t b a b b;
#X msg 214 211 16;
#X obj 214 263 t f f;
#X obj 77 28 inlet;
#X text 431 16 use the values of the most salien notes and the values
of the L profile and set an experimental velocity value for the notes.
This highlights the accents (theoretical) plus the syncopations found
on the pattern.;
#X obj 58 394 for;
#X msg 58 375 16;
#X obj 58 412 t f f;
#X obj 58 473 tabwrite velocity;
#X obj 126 170 t b b b;
#X obj 58 453 pow;
#X obj 506 404 inlet;
#X obj 214 304 + 2;
#X obj 393 307 tabread vel;
#X obj 378 351 tabwrite vel;
#X obj 214 283 tabread vel;
#X obj 214 324 tabwrite vel;
#X obj 59 432 tabread vel;
#X obj 555 218 table vel 16;
#X obj 506 424 t b f;
#X msg 145 347 \; vel normalize 1;
#X msg 369 104 \; vel 0 2 0 1 0 2 0 1 0 2 0 1 0 2 0 1 0;
#X obj 214 240 for;
#X connect 0 0 1 0;
#X connect 0 1 2 1;
#X connect 1 0 2 0;
#X connect 1 1 6 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 3 0 8 0;
#X connect 4 0 3 1;
#X connect 5 0 3 1;
#X connect 6 0 7 0;
#X connect 6 1 3 0;
#X connect 7 1 9 0;
#X connect 8 0 23 0;
#X connect 8 1 24 1;
#X connect 9 0 24 0;
#X connect 10 0 19 0;
#X connect 10 1 0 0;
#X connect 10 2 5 0;
#X connect 10 2 2 1;
#X connect 10 3 31 0;
#X connect 11 0 32 0;
#X connect 12 0 25 0;
#X connect 12 1 26 1;
#X connect 13 0 10 0;
#X connect 15 0 17 0;
#X connect 16 0 15 0;
#X connect 17 0 27 0;
#X connect 17 1 18 1;
#X connect 19 0 16 0;
#X connect 19 1 30 0;
#X connect 19 2 11 0;
#X connect 20 0 18 0;
#X connect 21 0 29 0;
#X connect 22 0 26 0;
#X connect 23 0 9 1;
#X connect 25 0 22 0;
#X connect 27 0 20 0;
#X connect 29 0 16 0;
#X connect 29 1 20 1;
#X connect 32 0 12 0;
#X restore 76 -37 pd calculate velocity;
#X text 167 -115 calculate the salience of a sequence. Outputs are
(allnotes \, only syncopations \, only reinforcements);
#X obj 76 -17 table velocity 16;
#X obj 628 12 tabread riddm;
#X obj 628 33 sel 1;
#X obj 714 -3 tabread velocity;
#X obj 628 -20 t f f;
#X obj 699 90 f;
#X text 118 -116 <-------;
#X text 15 -199 input an onset sequence;
#X obj 582 278 pack f f;
#X obj 582 300 outlet;
#X obj 432 27 f;
#X obj 508 -25 r fundamentals;
#X obj 508 0 unpack;
#X obj 473 28 f;
#X obj 432 -7 sel 0 1;
#X obj 458 206 f;
#X obj 601 139 t b f;
#X obj 819 -3 r tempo;
#X obj 819 22 * 4;
#X msg 819 48 60000 \$1;
#X obj 819 71 /;
#X obj 830 96 r bass-duration;
#X obj 830 120 t b f;
#X obj 819 155 * 1;
#X obj 607 -152 r current_step;
#X obj 628 -43 mod 16;
#X obj 165 80 r bass-octave;
#X obj 195 112 - 1;
#X obj 165 124 * 12;
#X obj 165 147 + 36;
#X obj 681 55 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 628 166 int;
#X obj 582 254 makenote 127 300;
#X obj 714 18 * 127;
#X obj 432 -29 >= 16;
#X floatatom 357 74 5 0 0 0 - - -;
#X obj 545 67 mod 2;
#X obj 607 -130 t f f f;
#X floatatom 529 94 5 0 0 0 - - -;
#X obj 487 145 * 12;
#X obj 471 180 + 0;
#X floatatom 202 221 5 0 0 0 - - -;
#X obj 449 100 + 24;
#X obj 199 -61 r bass-velocity;
#X floatatom 232 -36 5 0 0 0 - - -;
#X connect 0 0 3 0;
#X connect 0 0 2 0;
#X connect 3 1 4 0;
#X connect 7 0 8 0;
#X connect 8 0 11 0;
#X connect 8 0 36 0;
#X connect 9 0 39 0;
#X connect 10 0 7 0;
#X connect 10 1 9 0;
#X connect 11 0 22 0;
#X connect 14 0 15 0;
#X connect 16 0 48 0;
#X connect 17 0 18 0;
#X connect 18 0 16 1;
#X connect 18 1 19 1;
#X connect 19 0 48 0;
#X connect 20 0 16 0;
#X connect 20 1 19 0;
#X connect 21 0 38 0;
#X connect 22 0 21 0;
#X connect 22 1 37 0;
#X connect 23 0 24 0;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 26 0 29 0;
#X connect 27 0 28 0;
#X connect 28 0 29 0;
#X connect 28 1 29 1;
#X connect 29 0 38 2;
#X connect 30 0 43 0;
#X connect 31 0 10 0;
#X connect 32 0 33 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 35 0 47 0;
#X connect 37 0 38 1;
#X connect 38 0 14 0;
#X connect 38 1 14 1;
#X connect 39 0 11 1;
#X connect 40 0 20 0;
#X connect 40 0 41 0;
#X connect 42 0 44 0;
#X connect 42 0 45 0;
#X connect 43 0 31 0;
#X connect 43 1 40 0;
#X connect 43 2 42 0;
#X connect 45 0 46 1;
#X connect 46 0 21 1;
#X connect 48 0 46 0;
#X connect 49 0 4 1;
#X connect 49 0 50 0;
#X coords 0 652 1 651 240 17 0;
#X restore 23 211 pd onset2note;
#X text 107 209 <- look inside to adjust the note sequence;
#X obj 23 112 abs/populate_rhythm;
#X obj 23 238 noteout 2;
#X text 94 237 bass is on midi channel 2;
#X obj 35 142 prepend set;
#X msg 37 166 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1
0 0 1 0 0 0;
#X obj 134 60 r onsets-bass;
#X obj 36 40 r set-density;
#X obj 51 74 pipe 1;
#X obj 337 73 vradio 17 1 0 3 bass-octave set-bass-octave empty 0 -8
0 10 -262144 -1 -1 0;
#X text 293 73 OCTAVE;
#X obj 337 61 bng 8 250 50 0 learn-density --- empty 17 7 0 10 -262144
-1 -1;
#X obj 23 17 r bass-density;
#X connect 2 0 5 0;
#X connect 4 0 2 0;
#X connect 4 0 7 0;
#X connect 7 0 8 0;
#X connect 9 0 4 1;
#X connect 10 0 11 0;
#X connect 11 0 4 0;
#X connect 15 0 4 0;
#X restore -240 -226 pd BASS;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 4 0 2 0;
#X connect 15 0 16 0;
#X restore -336 23 pd patch by angel.faraldo@upf.edu;
#X obj -356 -110 cnv 15 100 20 empty empty BASS 20 12 0 14 -232576
-159808 0;
